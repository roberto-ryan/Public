(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const o of s)if(o.type==="childList")for(const l of o.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&r(l)}).observe(document,{childList:!0,subtree:!0});function n(s){const o={};return s.integrity&&(o.integrity=s.integrity),s.referrerPolicy&&(o.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?o.credentials="include":s.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function r(s){if(s.ep)return;s.ep=!0;const o=n(s);fetch(s.href,o)}})();const ht=!1,mt=(e,t)=>e===t,gt=Symbol("solid-track"),Ee={equals:mt};let et=rt;const ce=1,_e=2,tt={owned:null,cleanups:null,context:null,owner:null};var E=null;let Le=null,bt=null,A=null,O=null,re=null,Te=0;function xe(e,t){const n=A,r=E,s=e.length===0,o=t===void 0?r:t,l=s?tt:{owned:null,cleanups:null,context:o?o.context:null,owner:o},i=s?e:()=>e(()=>ae(()=>ve(l)));E=l,A=null;try{return Se(i,!0)}finally{A=n,E=r}}function q(e,t){t=t?Object.assign({},Ee,t):Ee;const n={value:e,observers:null,observerSlots:null,comparator:t.equals||void 0},r=s=>(typeof s=="function"&&(s=s(n.value)),it(n,s));return[st.bind(n),r]}function fe(e,t,n){const r=Ve(e,t,!1,ce);we(r)}function he(e,t,n){et=St;const r=Ve(e,t,!1,ce);r.user=!0,re?re.push(r):we(r)}function pe(e,t,n){n=n?Object.assign({},Ee,n):Ee;const r=Ve(e,t,!0,0);return r.observers=null,r.observerSlots=null,r.comparator=n.equals||void 0,we(r),st.bind(r)}function ae(e){if(A===null)return e();const t=A;A=null;try{return e()}finally{A=t}}function yt(e){he(()=>ae(e))}function nt(e){return E===null||(E.cleanups===null?E.cleanups=[e]:E.cleanups.push(e)),e}function st(){if(this.sources&&this.state)if(this.state===ce)we(this);else{const e=O;O=null,Se(()=>ke(this),!1),O=e}if(A){const e=this.observers?this.observers.length:0;A.sources?(A.sources.push(this),A.sourceSlots.push(e)):(A.sources=[this],A.sourceSlots=[e]),this.observers?(this.observers.push(A),this.observerSlots.push(A.sources.length-1)):(this.observers=[A],this.observerSlots=[A.sources.length-1])}return this.value}function it(e,t,n){let r=e.value;return(!e.comparator||!e.comparator(r,t))&&(e.value=t,e.observers&&e.observers.length&&Se(()=>{for(let s=0;s<e.observers.length;s+=1){const o=e.observers[s],l=Le&&Le.running;l&&Le.disposed.has(o),(l?!o.tState:!o.state)&&(o.pure?O.push(o):re.push(o),o.observers&&ot(o)),l||(o.state=ce)}if(O.length>1e6)throw O=[],new Error},!1)),t}function we(e){if(!e.fn)return;ve(e);const t=Te;vt(e,e.value,t)}function vt(e,t,n){let r;const s=E,o=A;A=E=e;try{r=e.fn(t)}catch(l){return e.pure&&(e.state=ce,e.owned&&e.owned.forEach(ve),e.owned=null),e.updatedAt=n+1,lt(l)}finally{A=o,E=s}(!e.updatedAt||e.updatedAt<=n)&&(e.updatedAt!=null&&"observers"in e?it(e,r):e.value=r,e.updatedAt=n)}function Ve(e,t,n,r=ce,s){const o={fn:e,state:r,updatedAt:null,owned:null,sources:null,sourceSlots:null,cleanups:null,value:t,owner:E,context:E?E.context:null,pure:n};return E===null||E!==tt&&(E.owned?E.owned.push(o):E.owned=[o]),o}function Ie(e){if(e.state===0)return;if(e.state===_e)return ke(e);if(e.suspense&&ae(e.suspense.inFallback))return e.suspense.effects.push(e);const t=[e];for(;(e=e.owner)&&(!e.updatedAt||e.updatedAt<Te);)e.state&&t.push(e);for(let n=t.length-1;n>=0;n--)if(e=t[n],e.state===ce)we(e);else if(e.state===_e){const r=O;O=null,Se(()=>ke(e,t[0]),!1),O=r}}function Se(e,t){if(O)return e();let n=!1;t||(O=[]),re?n=!0:re=[],Te++;try{const r=e();return wt(n),r}catch(r){n||(re=null),O=null,lt(r)}}function wt(e){if(O&&(rt(O),O=null),e)return;const t=re;re=null,t.length&&Se(()=>et(t),!1)}function rt(e){for(let t=0;t<e.length;t++)Ie(e[t])}function St(e){let t,n=0;for(t=0;t<e.length;t++){const r=e[t];r.user?e[n++]=r:Ie(r)}for(t=0;t<n;t++)Ie(e[t])}function ke(e,t){e.state=0;for(let n=0;n<e.sources.length;n+=1){const r=e.sources[n];if(r.sources){const s=r.state;s===ce?r!==t&&(!r.updatedAt||r.updatedAt<Te)&&Ie(r):s===_e&&ke(r,t)}}}function ot(e){for(let t=0;t<e.observers.length;t+=1){const n=e.observers[t];n.state||(n.state=_e,n.pure?O.push(n):re.push(n),n.observers&&ot(n))}}function ve(e){let t;if(e.sources)for(;e.sources.length;){const n=e.sources.pop(),r=e.sourceSlots.pop(),s=n.observers;if(s&&s.length){const o=s.pop(),l=n.observerSlots.pop();r<s.length&&(o.sourceSlots[l]=r,s[r]=o,n.observerSlots[r]=l)}}if(e.tOwned){for(t=e.tOwned.length-1;t>=0;t--)ve(e.tOwned[t]);delete e.tOwned}if(e.owned){for(t=e.owned.length-1;t>=0;t--)ve(e.owned[t]);e.owned=null}if(e.cleanups){for(t=e.cleanups.length-1;t>=0;t--)e.cleanups[t]();e.cleanups=null}e.state=0}function Ct(e){return e instanceof Error?e:new Error(typeof e=="string"?e:"Unknown error",{cause:e})}function lt(e,t=E){throw Ct(e)}const Pt=Symbol("fallback");function Je(e){for(let t=0;t<e.length;t++)e[t]()}function $t(e,t,n={}){let r=[],s=[],o=[],l=0,i=t.length>1?[]:null;return nt(()=>Je(o)),()=>{let f=e()||[],p=f.length,u,a;return f[gt],ae(()=>{let h,_,G,te,k,R,T,V,$;if(p===0)l!==0&&(Je(o),o=[],r=[],s=[],l=0,i&&(i=[])),n.fallback&&(r=[Pt],s[0]=xe(N=>(o[0]=N,n.fallback())),l=1);else if(l===0){for(s=new Array(p),a=0;a<p;a++)r[a]=f[a],s[a]=xe(d);l=p}else{for(G=new Array(p),te=new Array(p),i&&(k=new Array(p)),R=0,T=Math.min(l,p);R<T&&r[R]===f[R];R++);for(T=l-1,V=p-1;T>=R&&V>=R&&r[T]===f[V];T--,V--)G[V]=s[T],te[V]=o[T],i&&(k[V]=i[T]);for(h=new Map,_=new Array(V+1),a=V;a>=R;a--)$=f[a],u=h.get($),_[a]=u===void 0?-1:u,h.set($,a);for(u=R;u<=T;u++)$=r[u],a=h.get($),a!==void 0&&a!==-1?(G[a]=s[u],te[a]=o[u],i&&(k[a]=i[u]),a=_[a],h.set($,a)):o[u]();for(a=R;a<p;a++)a in G?(s[a]=G[a],o[a]=te[a],i&&(i[a]=k[a],i[a](a))):s[a]=xe(d);s=s.slice(0,l=p),r=f.slice(0)}return s});function d(h){if(o[a]=h,i){const[_,G]=q(a);return i[a]=G,t(f[a],_)}return t(f[a])}}}function L(e,t){return ae(()=>e(t||{}))}const At=e=>`Stale read from <${e}>.`;function Oe(e){const t="fallback"in e&&{fallback:()=>e.fallback};return pe($t(()=>e.each,e.children,t||void 0))}function z(e){const t=e.keyed,n=pe(()=>e.when,void 0,void 0),r=t?n:pe(n,void 0,{equals:(s,o)=>!s==!o});return pe(()=>{const s=r();if(s){const o=e.children;return typeof o=="function"&&o.length>0?ae(()=>o(t?s:()=>{if(!ae(r))throw At("Show");return n()})):o}return e.fallback},void 0,void 0)}const ze=e=>pe(()=>e());function Dt(e,t,n){let r=n.length,s=t.length,o=r,l=0,i=0,f=t[s-1].nextSibling,p=null;for(;l<s||i<o;){if(t[l]===n[i]){l++,i++;continue}for(;t[s-1]===n[o-1];)s--,o--;if(s===l){const u=o<r?i?n[i-1].nextSibling:n[o-i]:f;for(;i<o;)e.insertBefore(n[i++],u)}else if(o===i)for(;l<s;)(!p||!p.has(t[l]))&&t[l].remove(),l++;else if(t[l]===n[o-1]&&n[i]===t[s-1]){const u=t[--s].nextSibling;e.insertBefore(n[i++],t[l++].nextSibling),e.insertBefore(n[--o],u),t[s]=n[o]}else{if(!p){p=new Map;let a=i;for(;a<o;)p.set(n[a],a++)}const u=p.get(t[l]);if(u!=null)if(i<u&&u<o){let a=l,d=1,h;for(;++a<s&&a<o&&!((h=p.get(t[a]))==null||h!==u+d);)d++;if(d>u-i){const _=t[l];for(;i<u;)e.insertBefore(n[i++],_)}else e.replaceChild(n[i++],t[l++])}else l++;else t[l++].remove()}}}function xt(e,t,n,r={}){let s;return xe(o=>{s=o,t===document?e():g(t,e(),t.firstChild?null:void 0,n)},r.owner),()=>{s(),t.textContent=""}}function I(e,t,n,r){let s;const o=()=>{const i=document.createElement("template");return i.innerHTML=e,i.content.firstChild},l=()=>(s||(s=o())).cloneNode(!0);return l.cloneNode=l,l}function ue(e,t){t==null?e.removeAttribute("class"):e.className=t}function Be(e,t,n){return ae(()=>e(t,n))}function g(e,t,n,r){if(n!==void 0&&!r&&(r=[]),typeof t!="function")return Re(e,t,r,n);fe(s=>Re(e,t(),s,n),r)}function Re(e,t,n,r,s){for(;typeof n=="function";)n=n();if(t===n)return n;const o=typeof t,l=r!==void 0;if(e=l&&n[0]&&n[0].parentNode||e,o==="string"||o==="number"){if(o==="number"&&(t=t.toString(),t===n))return n;if(l){let i=n[0];i&&i.nodeType===3?i.data!==t&&(i.data=t):i=document.createTextNode(t),n=de(e,n,r,i)}else n!==""&&typeof n=="string"?n=e.firstChild.data=t:n=e.textContent=t}else if(t==null||o==="boolean")n=de(e,n,r);else{if(o==="function")return fe(()=>{let i=t();for(;typeof i=="function";)i=i();n=Re(e,i,n,r)}),()=>n;if(Array.isArray(t)){const i=[],f=n&&Array.isArray(n);if(Ge(i,t,n,s))return fe(()=>n=Re(e,i,n,r,!0)),()=>n;if(i.length===0){if(n=de(e,n,r),l)return n}else f?n.length===0?Xe(e,i,r):Dt(e,n,i):(n&&de(e),Xe(e,i));n=i}else if(t.nodeType){if(Array.isArray(n)){if(l)return n=de(e,n,r,t);de(e,n,null,t)}else n==null||n===""||!e.firstChild?e.appendChild(t):e.replaceChild(t,e.firstChild);n=t}}return n}function Ge(e,t,n,r){let s=!1;for(let o=0,l=t.length;o<l;o++){let i=t[o],f=n&&n[e.length],p;if(!(i==null||i===!0||i===!1))if((p=typeof i)=="object"&&i.nodeType)e.push(i);else if(Array.isArray(i))s=Ge(e,i,f)||s;else if(p==="function")if(r){for(;typeof i=="function";)i=i();s=Ge(e,Array.isArray(i)?i:[i],Array.isArray(f)?f:[f])||s}else e.push(i),s=!0;else{const u=String(i);f&&f.nodeType===3&&f.data===u?e.push(f):e.push(document.createTextNode(u))}}return s}function Xe(e,t,n=null){for(let r=0,s=t.length;r<s;r++)e.insertBefore(t[r],n)}function de(e,t,n,r){if(n===void 0)return e.textContent="";const s=r||document.createTextNode("");if(t.length){let o=!1;for(let l=t.length-1;l>=0;l--){const i=t[l];if(s!==i){const f=i.parentNode===e;!o&&!l?f?e.replaceChild(s,i):e.insertBefore(s,n):f&&i.remove()}else o=!0}}else e.insertBefore(s,n);return[s]}var Ye=I(`<div class=code>
`),Et=I("<div class=code><span class=bullet>"),Ue=I("<div class=code>"),_t=I('<div class="row warn">'),It=I("<div><div class=prompt-title></div><div class=prompt-sub>Parameter <!> of </div><div class=prompt-body><div class=code><span>"),kt=I("<div><div class=prompt-title>Command Ready</div><div class=prompt-body><div class=code></div><div class=section-subtle>Enter: copy • Esc: back"),Rt=I("<div class=prompt-overlay><div class=prompt>"),Tt=I("<div class=app><div class=header>VTS Tools Browser</div><div class=main><div><div class=pane-title>Categories</div><div class=list></div></div><div><div class=pane-title>Commands</div><div class=list></div></div><div><div class=pane-title>Details</div><div class=list></div></div></div><div class=footer></div><div>"),Nt=I("<div><span class=bullet></span> (<!>)"),Mt=I("<div><span class=bullet>"),Lt=I("<div class=section>Build Command:"),Ot=I('<div class="code preview-cmd">'),Bt=I("<div class=section>Synopsis:"),Ut=I("<div class=section>Description:"),Gt=I("<div class=section-subtle>Press Enter to start the parameter wizard"),Vt=I("<div class=section>Examples:"),Ft=I("<div><div class=code><span class=section>Name: </span></div><div class=code><span class=section>Category: </span></div><div class=code><span class=section>Path: "),Ht=I("<div> <!> &lt;<!>&gt; <!> ");const Ze=[{Category:"Utilities",Commands:[{Name:"Get-Thing",Category:"Utilities",Synopsis:"Gets a thing",Description:"Retrieves a sample thing.",Examples:[`Get-Thing -Name alpha
Name : alpha
Id   : 1`,`Get-Thing -Name beta
Name : beta
Id   : 2`],Parameters:[{Name:"Name",Required:!0,Type:"String",Position:0},{Name:"Verbose",Required:!1,Type:"Switch",Position:1}],Invocation:"Get-Thing",ScriptPath:"functions/Get-Thing.ps1"}]},{Category:"Networking",Commands:[{Name:"Test-Ping",Category:"Networking",Synopsis:"Ping a host",Description:"Pings a host and reports latency.",Examples:[`Test-Ping -Host example.com
Reply from 93.184.216.34: time=10ms`],Parameters:[{Name:"Host",Required:!0,Type:"String",Position:0},{Name:"Count",Required:!1,Type:"Int32",Position:1}],Invocation:"Test-Ping",ScriptPath:"functions/Test-Ping.ps1"}]}],De={bullet:"•"},qt=window.__MODEL__??[],ie={owner:"roberto-ryan",repo:"Public",branch:"main",path:"functions",categoryDepth:2,ignore:["functions","function","scripts","script","src","source","powershell","pwsh","ps","bin","build",".github",".vscode","lib","modules","module","samples","examples","test","tests","docs","documentation"]};function Kt(){const e=new URLSearchParams(location.search),t=e.get("repo")||`${ie.owner}/${ie.repo}`,[n,r]=t.split("/");return{owner:n||ie.owner,repo:r||ie.repo,branch:e.get("branch")||ie.branch,path:(e.get("path")||ie.path).replace(/^\/+|\/+$|^\.\/?/g,"").replace(/\\/g,"/"),categoryDepth:Math.max(1,Math.min(5,parseInt(e.get("depth")||`${ie.categoryDepth}`)||ie.categoryDepth)),ignore:(e.get("ignore")||ie.ignore.join(",")).split(",").map(s=>s.trim()).filter(Boolean),token:e.get("token")||void 0,preferFolderCategory:(e.get("preferFolder")??"1")!=="0"}}async function jt(e){const t=[],n=[e.path.replace(/^\/+|\/+$/g,"")];for(;n.length;){const r=n.shift();try{const s=`https://api.github.com/repos/${encodeURIComponent(e.owner)}/${encodeURIComponent(e.repo)}/contents/${encodeURIComponent(r)}?ref=${encodeURIComponent(e.branch)}`,o={Accept:"application/vnd.github+json"};e.token&&(o.Authorization=`Bearer ${e.token}`);const l=await fetch(s,{headers:o});if(!l.ok)throw new Error(`GitHub list failed ${l.status}`);const i=await l.json();for(const f of i)f.type==="dir"?n.push(f.path):f.type==="file"&&f.name.toLowerCase().endsWith(".ps1")&&t.push(f)}catch(s){console.warn("List failed for",r,s)}}return t}async function Wt(e,t,n){const r=new Array(e.length);let s=0,o=0,l,i;const f=new Promise((u,a)=>{l=u,i=a}),p=()=>{for(;o<t&&s<e.length;){const u=s++;o++,Promise.resolve(n(e[u],u)).then(a=>{r[u]=a,o--,s>=e.length&&o===0?l(r):p()},a=>{i(a)})}};return p(),f}function Qt(e){const t=e.match(/<#([\s\S]*?)#>/m);if(!t)return{};const n=t[1],r=d=>/^(none|no|parameters?|true|false|n\/a|na)$/i.test(d),s=Array.from(n.matchAll(/^\s*\.PARAMETER\s+([^\r\n]+)/gim)).map(d=>d[1].trim().split(/\s+/)[0]).filter(Boolean).filter(d=>!r(d)),o=n.split(/\r?\n/);let l=null;const i={};for(let d of o){const _=d.trim().match(/^\.(\w+)/);if(_){l=_[1].toUpperCase(),i[l]||(i[l]=[]);continue}l&&i[l].push(d.replace(/\s+$/,""))}const f=(i.SYNOPSIS||[]).join(`
`).trim(),p=(i.DESCRIPTION||[]).join(`
`).trim(),u=[],a=Object.keys(i).filter(d=>d==="EXAMPLE"||d.startsWith("EXAMPLE"));for(const d of a){const h=(i[d]||[]).join(`
`).trim();h&&u.push(h)}return{synopsis:f,description:p,examples:u,paramHelpNames:s}}function Jt(e){const t=e.search(/param\s*\(/i),n=[];if(t<0)return n;const r=e.indexOf("(",t);if(r<0)return n;let s=r+1,o=1,l=null;for(;s<e.length;s++){const d=e[s],h=e[s-1];if(l){d===l&&(l==='"'&&h==="`"||(e[s+1]===l?s++:l=null));continue}else{if(d==='"'||d==="'"){l=d;continue}if(d==="(")o++;else if(d===")"&&(o--,o===0))break}}const i=e.slice(r+1,s),f=[];let p="",u=0,a=0;l=null;for(let d=0;d<i.length;d++){const h=i[d],_=i[d-1];if(l){p+=h,h===l&&(l==='"'&&_==="`"||(i[d+1]===l?(p+=i[d+1],d++):l=null));continue}if(h==='"'||h==="'"){l=h,p+=h;continue}if(h==="["){a++,p+=h;continue}if(h==="]"){a=Math.max(0,a-1),p+=h;continue}if(h==="("){u++,p+=h;continue}if(h===")"){u=Math.max(0,u-1),p+=h;continue}if(h===","&&u===0&&a===0){p.trim()&&f.push(p.trim()),p="";continue}p+=h}p.trim()&&f.push(p.trim());for(const d of f){const h=Array.from(d.matchAll(/\$([A-Za-z_][\w]*)\b/g));if(h.length===0)continue;const _=X=>/^(true|false|null|env|_|psitem)$/i.test(X),G=h.find(X=>!_(X[1]));if(!G)continue;const te=G[1],k=d.slice(0,G.index),R=Array.from(k.matchAll(/\[([^\]]+)\]/g)).map(X=>X[1]);let T=!1,V=-1,$="";for(const X of R){const K=X.trim();if(K.toLowerCase().startsWith("parameter(")){const Y=K.slice(K.indexOf("(")+1,K.lastIndexOf(")")),ge=Y.match(/mandatory\s*=\s*\$?(true|false)/i);ge?T=ge[1].toLowerCase()==="true":/\bmandatory\b/i.test(Y)&&(T=!0);const oe=Y.match(/position\s*=\s*(-?\d+)/i);oe&&(V=parseInt(oe[1]))}else!/^validate\w*\s*\(/i.test(K)&&!/^alias\s*\(/i.test(K)&&($=K)}const N=/switch/i.test($)?"Switch":/bool/i.test($)?"Boolean":/int(16|32|64)?/i.test($)?"Int32":/string/i.test($)?"String":$||"Object";n.push({Name:te,Required:T,Type:N,Position:V})}return n}const zt=[[/\b(M365|O365|Office365|ExchangeOnline|SharePointOnline|OneDrive|Teams|Outlook|Planner|PowerPlatform|PowerApps|PowerAutomate)\b/i,"Microsoft 365"],[/\b(ActiveDirectory|ADFS|ADDS|DomainController|SAMAccount|Kerberos|LDAP|AAD|AzureAD|EntraID)\b/i,"Identity"],[/\b(Security|SecPol|ACL|Permissions|Credential|Secrets|PKI|Certificate|TLS|SSL|Firewall|Malware|Virus|Defender|AppLocker|BitLocker|Encryption)\b/i,"Security"],[/\b(Intune|SCCM|ConfigMgr|EndpointManager|MDM|GPO|GroupPolicy)\b/i,"Endpoint Mgmt"],[/\b(Azure|ARM|ResourceGroup|VMSS|AKS|AppService|KeyVault|StorageAccount|CosmosDB|LogicApp|FunctionApp|VNet|NSG)\b/i,"Azure"],[/\b(Jira|Confluence|DevOps|Agile|Scrum|Kanban|Trello|Asana)\b/i,"Dev/Work Mgmt"],[/\b(Hyper-V|VMware|vSphere|ESXi|VirtualBox|VHDX?|Snapshot|Checkpoint)\b/i,"Virtualization"],[/\b(Docker|Podman|Containerd|K8s|Kubernetes|Helm|Image|Container)\b/i,"Containers"],[/\b(DevOps|Terraform|Ansible|Chef|Puppet|Bicep|ARMTemplate|CI\/CD|Pipeline|Jenkins|Octopus)\b/i,"DevOps/IaC"],[/\b(SQLServer|MSSQL|Postgres|PostgreSQL|MySQL|MariaDB|OracleDB|MongoDB|Redis|Database|SQLite)\b/i,"Databases"],[/\b(OAuth|OIDC|SAML|JWT|FIDO2|MFA|2FA|SSO|AuthN|AuthZ)\b/i,"Auth Standards"],[/\b(AWS|AmazonWebServices|EC2|S3|GCP|GoogleCloud|BigQuery|CloudRun)\b/i,"Cloud Vendors"],[/\b(Network|NetCfg|DNS|DHCP|IPConfig|Ping|Traceroute|Subnet|Routing|Switch|Router|WiFi|NAT|Port|TCP|UDP|SSLVPN|VPN)\b/i,"Networking"],[/\b(PowerShell|Bash|Python|CSharp|C#|JavaScript|TypeScript|GoLang?|Rust|Perl|Ruby)\b/i,"Languages"],[/\b(Backup|Restore|Recovery|Snapshot|Replication|Failover|DisasterRecovery|DR|Veeam)\b/i,"Backup and DR"],[/\b(Exchange|SMTP|IMAP|POP3|Mailbox|MailFlow|SendMail)\b/i,"Email"],[/\b(Help|Get-Help|About_|Info|Discover|WhatIf)\b/i,"Help/Discovery"],[/\b(Process|Tasklist|Taskkill|Get-Process|ProcMon|Handle)\b/i,"Processes"],[/\b(Service|Get-Service|Set-Service|Start-Service|Stop-Service|Restart-Service)\b/i,"Services"],[/\b(File|Folder|Directory|Path|Copy-Item|Move-Item|Remove-Item|Rename-Item|New-Item|Get-ChildItem|Tree)\b/i,"Files/Directories"],[/\b(Registry|RegKey|HKLM|HKCU|HKCR|HKU|HKCC|Get-ItemProperty|Set-ItemProperty)\b/i,"Registry"],[/\b(EventLog|Get-EventLog|Get-WinEvent|LogName|ApplicationLog|SystemLog|Audit)\b/i,"Events/Logs"],[/\b(Device|PnP|Driver|Hardware|Disk|Volume|Partition|USB|PrinterPort|Monitor|Battery|Adapter)\b/i,"Hardware/Devices"],[/\b(Print|Printer|PrintJob|Spooler|PrintQueue)\b/i,"Printing"],[/\b(Update|Patch|WUInstall|WindowsUpdate|KB\d+)\b/i,"Updates"],[/\b(User|Group|LocalUser|LocalGroup|Account|SID|Profile|Credential|NTUser)\b/i,"Users/Groups"],[/\b(PerfMon|Performance|Counter|ResourceMonitor|CPU|Memory|DiskIO|Latency|Benchmark)\b/i,"Performance"],[/\b(PowerPlan|Battery|Sleep|Hibernate|Shutdown|Restart|Reboot|UPS)\b/i,"Power"],[/\b(Display|Resolution|Monitor|Screen|Graphics|DPI|Color|Brightness)\b/i,"Display"],[/\b(Keyboard|Mouse|Input|HID|Touchpad|Tablet|Pen)\b/i,"Input"],[/\b(Audio|Sound|Speaker|Microphone|Mute|Volume)\b/i,"Audio"],[/\b(Troubleshoot|Diag|Diagnosis|Fix|Repair|Checkup|Health|SFC|DISM)\b/i,"Troubleshooting"],[/\b(Install|Setup|Deployment|Sysprep|ImageX|WIM|ISO|Provisioning)\b/i,"Installation"],[/\b(Recovery|WinRE|Reset|RestorePoint|SystemRestore|BootRepair)\b/i,"Recovery"],[/\b(Util|Utility|Tool|Script|Helper|AdminTool|Sysinternals)\b/i,"Utilities"]];function Xt(e,t,n){const r=t.replace(/\\/g,"/"),s=e.path.replace(/\\/g,"/").replace(/^\/+|\/+$/g,""),o=r.toLowerCase().indexOf(s.toLowerCase()),f=(o>=0?r.slice(o+s.length).replace(/^\/+/,""):r).split("/").slice(0,-1).filter(Boolean).filter(d=>!e.ignore.some(h=>h.toLowerCase()===d.toLowerCase())).slice(0,e.categoryDepth),p=f.length?f.join(" / "):"";let u="";const a=`${t}
${n||""}`;for(const[d,h]of zt)if(d.test(a)){u=h;break}return e.preferFolderCategory?p||u||"General":u||p||"General"}function Yt(e,t,n){const r=t.match(/^[\s\S]{0,2000}?function\s+([A-Za-z0-9_-]+)\b/m),s=(r==null?void 0:r[1])||n.split("/").pop().replace(/\.ps1$/i,""),o=Qt(t),l=Jt(t),i=new Map(l.map(u=>[u.Name.toLowerCase(),u])),f=u=>new RegExp(`\\$${u}\\b`,"i").test(t);for(const u of o.paramHelpNames||[]){const a=u.toLowerCase();!i.has(a)&&f(u)&&i.set(a,{Name:u,Required:!1,Type:"String",Position:0})}const p=Array.from(i.values()).sort((u,a)=>u.Position-a.Position);return{Name:s,Category:Xt(e,n,t),Synopsis:o.synopsis||"",Description:o.description||"",Examples:o.examples||[],Parameters:p,Invocation:s,ScriptPath:n}}async function Zt(e,t){try{if(e.token){const r=`https://api.github.com/repos/${encodeURIComponent(e.owner)}/${encodeURIComponent(e.repo)}/contents/${encodeURIComponent(t.path)}?ref=${encodeURIComponent(e.branch)}`,s=await fetch(r,{headers:{Accept:"application/vnd.github+json",Authorization:`Bearer ${e.token}`}});if(!s.ok)return null;const o=await s.json();if(o&&typeof o.content=="string")try{return atob(o.content.replace(/\n/g,""))}catch{return null}return null}if(!t.download_url)return null;const n=await fetch(t.download_url);return n.ok?await n.text():null}catch{return null}}async function en(e){const t=await jt(e),r=(await Wt(t,6,async i=>{const f=await Zt(e,i);return f?Yt(e,f,i.path):null})).filter(Boolean),s=new Map;for(const i of r){const f=i.Category||"General";s.has(f)||s.set(f,[]),s.get(f).push(i)}const o=Array.from(s.entries()).sort((i,f)=>i[0].localeCompare(f[0])).map(([i,f])=>({Category:i,Commands:f.sort((p,u)=>p.Name.localeCompare(u.Name))})),l=`${e.owner}/${e.repo}@${e.branch} • ${e.path}`;return{groups:o,title:l}}function tn(){const e=Kt(),[t,n]=q(qt),[r,s]=q("Loading…"),[o,l]=q(""),[i,f]=q(0),[p,u]=q(0),[a,d]=q("cat"),[h,_]=q("Left/Right: change pane  |  Up/Down: select or scroll  |  Enter: build/copy command  |  Ctrl+C: exit"),[G,te]=q(""),[k,R]=q({}),[T,V]=q(0),[$,N]=q("off"),[X,K]=q(0),[me,Y]=q(""),ge=" Left/Right: change pane  |  Up/Down: select or scroll  |  Enter: build/copy  |  Ctrl+C: exit ";_(ge);const oe=pe(()=>{var c;return((c=t()[i()])==null?void 0:c.Commands)??[]}),Q=pe(()=>oe()[p()]);let Fe,He,F;const Ce=c=>{F&&F.scrollBy({top:c,behavior:"auto"})},qe=(c,y)=>{requestAnimationFrame(()=>{if(!c||y==null||y<0)return;const w=c.querySelectorAll(".row")[y];w&&typeof w.scrollIntoView=="function"&&w.scrollIntoView({block:"nearest"})})},Ke=c=>{const y=c.target;if(((y==null?void 0:y.tagName)||"").toLowerCase(),$()!=="off"){const v=Q(),w=(v==null?void 0:v.Parameters)||[],C=X();if($()==="param"&&v&&w[C]){const S=w[C],j=S.Type||"String";if(/switch|boolean/i.test(j)){if(c.key===" "){const H=!!k()[S.Name];R({...k(),[S.Name]:!H}),c.preventDefault();return}if(c.key==="Enter"){const H=C+1;if(H<w.length)K(H);else{const B=Q();if(B){const Z=je(B,k());Z.length?(K(Z[0]),N("param")):N("summary")}else N("summary")}return}if(c.key==="Escape"){N("off");return}return}else{if(c.key==="Enter"){const B=me().trim();if(B)R({...k(),[S.Name]:B});else{const ne={...k()};delete ne[S.Name],R(ne)}Y("");const Z=C+1;if(Z<w.length)K(Z);else{const ne=Q();if(ne){const le=je(ne,k());le.length?(K(le[0]),N("param")):N("summary")}else N("summary")}return}if(c.key==="Escape"){N("off"),Y("");return}if(c.key==="Backspace"||c.key==="Delete"){Y(me().slice(0,-1)),c.preventDefault();return}if(c.key.length===1&&!c.ctrlKey&&!c.metaKey&&!c.altKey){Y(me()+c.key),c.preventDefault();return}return}}if($()==="summary"){if(c.key==="Enter"){const S=Q();S&&(ct(Ne(S)),ut("Command copied to clipboard")),N("off");return}if(c.key==="Escape"){N("off");return}return}}switch(c.key){case"Enter":{const v=Q();if(v){const w=v.Parameters||[];if(w.length===0)N("summary");else{K(0);const C=w[0];/switch|boolean/i.test(C.Type||"")?Y(""):Y(String(k()[C.Name]??"")),N("param"),_(" Enter: accept  |  Space: toggle  |  Esc: cancel ")}}break}case"ArrowUp":{a()==="cat"?(i()>0&&f(i()-1),c.preventDefault()):a()==="cmd"?(p()>0&&u(p()-1),c.preventDefault()):a()==="detail"&&(Ce(-24),c.preventDefault());break}case"ArrowDown":{a()==="cat"?(i()<t().length-1&&f(i()+1),c.preventDefault()):a()==="cmd"?(p()<oe().length-1&&u(p()+1),c.preventDefault()):a()==="detail"&&(Ce(24),c.preventDefault());break}case"PageUp":{a()==="detail"&&(Ce(-((F==null?void 0:F.clientHeight)||200)*.85),c.preventDefault());break}case"PageDown":{a()==="detail"&&(Ce(((F==null?void 0:F.clientHeight)||200)*.85),c.preventDefault());break}case"Home":{a()==="detail"&&F&&(F.scrollTo({top:0,behavior:"auto"}),c.preventDefault());break}case"End":{a()==="detail"&&F&&(F.scrollTo({top:F.scrollHeight,behavior:"auto"}),c.preventDefault());break}case"ArrowLeft":{a()==="cmd"?d("cat"):a()==="detail"&&d("cmd"),c.preventDefault();break}case"ArrowRight":{a()==="cat"?d("cmd"):a()==="cmd"&&d("detail"),c.preventDefault();break}}};yt(()=>{window.addEventListener("keydown",Ke),(async()=>{try{const{groups:c,title:y}=await en(e);c.length===0?(n(Ze),s("Demo Data")):(n(c),s(y))}catch(c){l((c==null?void 0:c.message)||String(c)),n(Ze),s("Demo Data (GitHub load failed)")}f(0),u(0)})()}),nt(()=>window.removeEventListener("keydown",Ke)),he(()=>{oe(),u(0)}),he(()=>{t(),qe(Fe,i())}),he(()=>{oe(),qe(He,p())}),he(()=>{const c=Q();if(!c)return;const y={};for(const v of c.Parameters||[]){const w=v.Name;/switch|boolean/i.test(v.Type)?y[w]=!1:y[w]=""}R(y),V(0)});function at(c){return`'${String(c).replace(/'/g,"''")}'`}function Ne(c){const y=c.Invocation||c.Name,v=k(),w=[],C=[],S=c.Parameters||[];for(const D of S){const H=D.Name;let B=v[H];const Z=/switch/i.test(D.Type);if(/boolean/i.test(D.Type),!(Z?!!B:B!=null&&String(B).trim()!==""))continue;if(Z){w.push(`-${H}`);continue}const le=/int|double|float|decimal/i.test(D.Type)?String(B):at(String(B));typeof D.Position=="number"&&D.Position>=0?C.push({pos:D.Position,text:le}):w.push(`-${H} ${le}`)}return C.sort((D,H)=>D.pos-H.pos),[y,...C.map(D=>D.text),...w].join(" ")}function je(c,y){const v=[],w=c.Parameters||[];for(let C=0;C<w.length;C++){const S=w[C];if(!S.Required)continue;const j=S.Type||"String",D=y[S.Name];/switch|boolean/i.test(j)?D||v.push(C):(D==null||String(D).trim()==="")&&v.push(C)}return v}function ct(c){var y;(y=navigator.clipboard)==null||y.writeText(c).catch(()=>{const v=document.createElement("textarea");v.value=c,document.body.appendChild(v),v.select(),document.execCommand("copy"),document.body.removeChild(v)})}function ut(c){te(c),setTimeout(()=>te(""),1500)}he(()=>{$()==="off"&&_(ge)});const ft=(c=[])=>{const y=[];return c.slice(0,3).forEach((v,w)=>{w>0&&y.push(Ye());const C=v.replace(/\r\n/g,`
`).replace(/\r/g,`
`).split(`
`);C.length>0&&(y.push((()=>{var S=Et(),j=S.firstChild;return g(j,()=>De.bullet),g(S,()=>C[0],null),S})()),y.push(Ye()));for(let S=1;S<C.length;S++)y.push((()=>{var j=Ue();return g(j,()=>"  "+C[S].replace(/\s+$/,"")),j})())}),y};return(()=>{var c=Tt(),y=c.firstChild,v=y.nextSibling,w=v.firstChild,C=w.firstChild,S=C.nextSibling,j=w.nextSibling,D=j.firstChild,H=D.nextSibling,B=j.nextSibling,Z=B.firstChild,ne=Z.nextSibling,le=v.nextSibling,Me=le.nextSibling;return Be(m=>Fe=m,S),g(S,L(z,{get when(){return o()},get children(){var m=_t();return g(m,o),m}}),null),g(S,L(Oe,{get each(){return t()},children:(m,x)=>(()=>{var P=Nt(),M=P.firstChild,U=M.nextSibling,b=U.nextSibling;return b.nextSibling,g(M,()=>De.bullet),g(P,()=>m.Category,U),g(P,()=>{var se;return((se=m.Commands)==null?void 0:se.length)??0},b),fe(()=>ue(P,"row "+(x()==i()?"selected":""))),P})()}),null),Be(m=>He=m,H),g(H,L(Oe,{get each(){return oe()},children:(m,x)=>(()=>{var P=Mt(),M=P.firstChild;return g(M,()=>De.bullet),g(P,()=>m.Name,null),fe(()=>ue(P,"row "+(x()==p()?"selected":""))),P})()})),Be(m=>F=m,ne),g(ne,L(z,{get when(){return Q()},children:m=>(()=>{var x=Ft(),P=x.firstChild;P.firstChild;var M=P.nextSibling;M.firstChild;var U=M.nextSibling;return U.firstChild,g(P,()=>m().Name,null),g(M,()=>m().Category,null),g(U,()=>m().ScriptPath,null),g(x,L(z,{get when(){var b;return(b=m().Parameters)==null?void 0:b.length},get children(){return[Lt(),(()=>{var b=Ot();return g(b,()=>Ne(m())),b})()]}}),null),g(x,L(z,{get when(){return m().Synopsis},get children(){return Bt()}}),null),g(x,L(z,{get when(){return m().Synopsis},get children(){var b=Ue();return g(b,()=>m().Synopsis),b}}),null),g(x,L(z,{get when(){return m().Description},get children(){return Ut()}}),null),g(x,L(z,{get when(){return m().Description},get children(){var b=Ue();return g(b,()=>m().Description),b}}),null),g(x,L(z,{get when(){var b;return(b=m().Parameters)==null?void 0:b.length},get children(){return[Gt(),L(Oe,{get each(){return m().Parameters},children:(b,se)=>{const Pe=b.Type||"String",be=k()[b.Name],$e=/switch|boolean/i.test(Pe),W=$e?$e&&!!be?"[On]":"[Off]":be?String(be):b.Required?"<required>":"";return(()=>{var J=Ht(),ye=J.firstChild,Ae=ye.nextSibling,pt=Ae.nextSibling,We=pt.nextSibling,dt=We.nextSibling,Qe=dt.nextSibling;return Qe.nextSibling,g(J,()=>De.bullet,ye),g(J,()=>b.Name,Ae),g(J,Pe,We),g(J,()=>b.Required?"(required)":"(optional)",Qe),g(J,W?"— "+W:"",null),fe(()=>ue(J,"code param-item "+(se()==T()?"selected":""))),J})()}})]}}),null),g(x,L(z,{get when(){var b;return(b=m().Examples)==null?void 0:b.length},get children(){return[Vt(),ze(()=>ft(m().Examples))]}}),null),x})()})),g(le,h),g(c,L(z,{get when(){return $()!=="off"},get children(){var m=Rt(),x=m.firstChild;return g(x,L(z,{get when(){return $()==="param"},get children(){var P=It(),M=P.firstChild,U=M.nextSibling,b=U.firstChild,se=b.nextSibling;se.nextSibling;var Pe=U.nextSibling,be=Pe.firstChild,$e=be.firstChild;return g(M,()=>{var ee;return(ee=Q())==null?void 0:ee.Name}),g(U,()=>X()+1,se),g(U,()=>{var ee,W;return((W=(ee=Q())==null?void 0:ee.Parameters)==null?void 0:W.length)||0},null),g($e,()=>{var ye;const ee=Q(),W=(ye=ee==null?void 0:ee.Parameters)==null?void 0:ye[X()];if(!W)return"";const J=W.Type||"String";if(/switch|boolean/i.test(J)){const Ae=!!k()[W.Name];return`${W.Name} <${J}> ${W.Required?"(required)":"(optional)"} — ${Ae?"[On]":"[Off]"}

Space: toggle • Enter: next • Esc: cancel`}return`${W.Name} <${J}> ${W.Required?"(required)":"(optional)"}

${me()}_

Type to enter • Enter: next • Esc: cancel`}),P}}),null),g(x,L(z,{get when(){return $()==="summary"},get children(){var P=kt(),M=P.firstChild,U=M.nextSibling,b=U.firstChild;return g(b,(()=>{var se=ze(()=>!!Q());return()=>se()?Ne(Q()):""})()),P}}),null),m}}),Me),g(Me,G),fe(m=>{var x="pane pane-cats "+(a()==="cat"?"active":""),P="pane pane-cmds "+(a()==="cmd"?"active":""),M="pane "+(a()==="detail"?"active":""),U="copy-toast "+(G()?"show":"");return x!==m.e&&ue(w,m.e=x),P!==m.t&&ue(j,m.t=P),M!==m.a&&ue(B,m.a=M),U!==m.o&&ue(Me,m.o=U),m},{e:void 0,t:void 0,a:void 0,o:void 0}),c})()}xt(()=>L(tn,{}),document.getElementById("root"));
