(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const o of i)if(o.type==="childList")for(const l of o.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&r(l)}).observe(document,{childList:!0,subtree:!0});function n(i){const o={};return i.integrity&&(o.integrity=i.integrity),i.referrerPolicy&&(o.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?o.credentials="include":i.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function r(i){if(i.ep)return;i.ep=!0;const o=n(i);fetch(i.href,o)}})();const mt=!1,gt=(e,t)=>e===t,bt=Symbol("solid-track"),Ee={equals:gt};let tt=ot;const ce=1,Re=2,nt={owned:null,cleanups:null,context:null,owner:null};var T=null;let Me=null,yt=null,R=null,G=null,se=null,Te=0;function xe(e,t){const n=R,r=T,i=e.length===0,o=t===void 0?r:t,l=i?nt:{owned:null,cleanups:null,context:o?o.context:null,owner:o},s=i?e:()=>e(()=>ae(()=>we(l)));T=l,R=null;try{return Se(s,!0)}finally{R=n,T=r}}function K(e,t){t=t?Object.assign({},Ee,t):Ee;const n={value:e,observers:null,observerSlots:null,comparator:t.equals||void 0},r=i=>(typeof i=="function"&&(i=i(n.value)),st(n,i));return[rt.bind(n),r]}function fe(e,t,n){const r=Fe(e,t,!1,ce);ve(r)}function he(e,t,n){tt=Ct;const r=Fe(e,t,!1,ce);r.user=!0,se?se.push(r):ve(r)}function pe(e,t,n){n=n?Object.assign({},Ee,n):Ee;const r=Fe(e,t,!0,0);return r.observers=null,r.observerSlots=null,r.comparator=n.equals||void 0,ve(r),rt.bind(r)}function ae(e){if(R===null)return e();const t=R;R=null;try{return e()}finally{R=t}}function wt(e){he(()=>ae(e))}function it(e){return T===null||(T.cleanups===null?T.cleanups=[e]:T.cleanups.push(e)),e}function rt(){if(this.sources&&this.state)if(this.state===ce)ve(this);else{const e=G;G=null,Se(()=>ke(this),!1),G=e}if(R){const e=this.observers?this.observers.length:0;R.sources?(R.sources.push(this),R.sourceSlots.push(e)):(R.sources=[this],R.sourceSlots=[e]),this.observers?(this.observers.push(R),this.observerSlots.push(R.sources.length-1)):(this.observers=[R],this.observerSlots=[R.sources.length-1])}return this.value}function st(e,t,n){let r=e.value;return(!e.comparator||!e.comparator(r,t))&&(e.value=t,e.observers&&e.observers.length&&Se(()=>{for(let i=0;i<e.observers.length;i+=1){const o=e.observers[i],l=Me&&Me.running;l&&Me.disposed.has(o),(l?!o.tState:!o.state)&&(o.pure?G.push(o):se.push(o),o.observers&&lt(o)),l||(o.state=ce)}if(G.length>1e6)throw G=[],new Error},!1)),t}function ve(e){if(!e.fn)return;we(e);const t=Te;vt(e,e.value,t)}function vt(e,t,n){let r;const i=T,o=R;R=T=e;try{r=e.fn(t)}catch(l){return e.pure&&(e.state=ce,e.owned&&e.owned.forEach(we),e.owned=null),e.updatedAt=n+1,at(l)}finally{R=o,T=i}(!e.updatedAt||e.updatedAt<=n)&&(e.updatedAt!=null&&"observers"in e?st(e,r):e.value=r,e.updatedAt=n)}function Fe(e,t,n,r=ce,i){const o={fn:e,state:r,updatedAt:null,owned:null,sources:null,sourceSlots:null,cleanups:null,value:t,owner:T,context:T?T.context:null,pure:n};return T===null||T!==nt&&(T.owned?T.owned.push(o):T.owned=[o]),o}function _e(e){if(e.state===0)return;if(e.state===Re)return ke(e);if(e.suspense&&ae(e.suspense.inFallback))return e.suspense.effects.push(e);const t=[e];for(;(e=e.owner)&&(!e.updatedAt||e.updatedAt<Te);)e.state&&t.push(e);for(let n=t.length-1;n>=0;n--)if(e=t[n],e.state===ce)ve(e);else if(e.state===Re){const r=G;G=null,Se(()=>ke(e,t[0]),!1),G=r}}function Se(e,t){if(G)return e();let n=!1;t||(G=[]),se?n=!0:se=[],Te++;try{const r=e();return St(n),r}catch(r){n||(se=null),G=null,at(r)}}function St(e){if(G&&(ot(G),G=null),e)return;const t=se;se=null,t.length&&Se(()=>tt(t),!1)}function ot(e){for(let t=0;t<e.length;t++)_e(e[t])}function Ct(e){let t,n=0;for(t=0;t<e.length;t++){const r=e[t];r.user?e[n++]=r:_e(r)}for(t=0;t<n;t++)_e(e[t])}function ke(e,t){e.state=0;for(let n=0;n<e.sources.length;n+=1){const r=e.sources[n];if(r.sources){const i=r.state;i===ce?r!==t&&(!r.updatedAt||r.updatedAt<Te)&&_e(r):i===Re&&ke(r,t)}}}function lt(e){for(let t=0;t<e.observers.length;t+=1){const n=e.observers[t];n.state||(n.state=Re,n.pure?G.push(n):se.push(n),n.observers&&lt(n))}}function we(e){let t;if(e.sources)for(;e.sources.length;){const n=e.sources.pop(),r=e.sourceSlots.pop(),i=n.observers;if(i&&i.length){const o=i.pop(),l=n.observerSlots.pop();r<i.length&&(o.sourceSlots[l]=r,i[r]=o,n.observerSlots[r]=l)}}if(e.tOwned){for(t=e.tOwned.length-1;t>=0;t--)we(e.tOwned[t]);delete e.tOwned}if(e.owned){for(t=e.owned.length-1;t>=0;t--)we(e.owned[t]);e.owned=null}if(e.cleanups){for(t=e.cleanups.length-1;t>=0;t--)e.cleanups[t]();e.cleanups=null}e.state=0}function $t(e){return e instanceof Error?e:new Error(typeof e=="string"?e:"Unknown error",{cause:e})}function at(e,t=T){throw $t(e)}const Pt=Symbol("fallback");function ze(e){for(let t=0;t<e.length;t++)e[t]()}function At(e,t,n={}){let r=[],i=[],o=[],l=0,s=t.length>1?[]:null;return it(()=>ze(o)),()=>{let u=e()||[],f=u.length,p,a;return u[bt],ae(()=>{let m,_,M,v,$,D,N,O,g;if(f===0)l!==0&&(ze(o),o=[],r=[],i=[],l=0,s&&(s=[])),n.fallback&&(r=[Pt],i[0]=xe(A=>(o[0]=A,n.fallback())),l=1);else if(l===0){for(i=new Array(f),a=0;a<f;a++)r[a]=u[a],i[a]=xe(b);l=f}else{for(M=new Array(f),v=new Array(f),s&&($=new Array(f)),D=0,N=Math.min(l,f);D<N&&r[D]===u[D];D++);for(N=l-1,O=f-1;N>=D&&O>=D&&r[N]===u[O];N--,O--)M[O]=i[N],v[O]=o[N],s&&($[O]=s[N]);for(m=new Map,_=new Array(O+1),a=O;a>=D;a--)g=u[a],p=m.get(g),_[a]=p===void 0?-1:p,m.set(g,a);for(p=D;p<=N;p++)g=r[p],a=m.get(g),a!==void 0&&a!==-1?(M[a]=i[p],v[a]=o[p],s&&($[a]=s[p]),a=_[a],m.set(g,a)):o[p]();for(a=D;a<f;a++)a in M?(i[a]=M[a],o[a]=v[a],s&&(s[a]=$[a],s[a](a))):i[a]=xe(b);i=i.slice(0,l=f),r=u.slice(0)}return i});function b(m){if(o[a]=m,s){const[_,M]=K(a);return s[a]=M,t(u[a],_)}return t(u[a])}}}function B(e,t){return ae(()=>e(t||{}))}const Dt=e=>`Stale read from <${e}>.`;function Oe(e){const t="fallback"in e&&{fallback:()=>e.fallback};return pe(At(()=>e.each,e.children,t||void 0))}function X(e){const t=e.keyed,n=pe(()=>e.when,void 0,void 0),r=t?n:pe(n,void 0,{equals:(i,o)=>!i==!o});return pe(()=>{const i=r();if(i){const o=e.children;return typeof o=="function"&&o.length>0?ae(()=>o(t?i:()=>{if(!ae(r))throw Dt("Show");return n()})):o}return e.fallback},void 0,void 0)}const Je=e=>pe(()=>e());function xt(e,t,n){let r=n.length,i=t.length,o=r,l=0,s=0,u=t[i-1].nextSibling,f=null;for(;l<i||s<o;){if(t[l]===n[s]){l++,s++;continue}for(;t[i-1]===n[o-1];)i--,o--;if(i===l){const p=o<r?s?n[s-1].nextSibling:n[o-s]:u;for(;s<o;)e.insertBefore(n[s++],p)}else if(o===s)for(;l<i;)(!f||!f.has(t[l]))&&t[l].remove(),l++;else if(t[l]===n[o-1]&&n[s]===t[i-1]){const p=t[--i].nextSibling;e.insertBefore(n[s++],t[l++].nextSibling),e.insertBefore(n[--o],p),t[i]=n[o]}else{if(!f){f=new Map;let a=s;for(;a<o;)f.set(n[a],a++)}const p=f.get(t[l]);if(p!=null)if(s<p&&p<o){let a=l,b=1,m;for(;++a<i&&a<o&&!((m=f.get(t[a]))==null||m!==p+b);)b++;if(b>p-s){const _=t[l];for(;s<p;)e.insertBefore(n[s++],_)}else e.replaceChild(n[s++],t[l++])}else l++;else t[l++].remove()}}}function Et(e,t,n,r={}){let i;return xe(o=>{i=o,t===document?e():h(t,e(),t.firstChild?null:void 0,n)},r.owner),()=>{i(),t.textContent=""}}function L(e,t,n,r){let i;const o=()=>{const s=document.createElement("template");return s.innerHTML=e,s.content.firstChild},l=()=>(i||(i=o())).cloneNode(!0);return l.cloneNode=l,l}function ue(e,t){t==null?e.removeAttribute("class"):e.className=t}function Ue(e,t,n){return ae(()=>e(t,n))}function h(e,t,n,r){if(n!==void 0&&!r&&(r=[]),typeof t!="function")return Ie(e,t,r,n);fe(i=>Ie(e,t(),i,n),r)}function Ie(e,t,n,r,i){for(;typeof n=="function";)n=n();if(t===n)return n;const o=typeof t,l=r!==void 0;if(e=l&&n[0]&&n[0].parentNode||e,o==="string"||o==="number"){if(o==="number"&&(t=t.toString(),t===n))return n;if(l){let s=n[0];s&&s.nodeType===3?s.data!==t&&(s.data=t):s=document.createTextNode(t),n=de(e,n,r,s)}else n!==""&&typeof n=="string"?n=e.firstChild.data=t:n=e.textContent=t}else if(t==null||o==="boolean")n=de(e,n,r);else{if(o==="function")return fe(()=>{let s=t();for(;typeof s=="function";)s=s();n=Ie(e,s,n,r)}),()=>n;if(Array.isArray(t)){const s=[],u=n&&Array.isArray(n);if(Ge(s,t,n,i))return fe(()=>n=Ie(e,s,n,r,!0)),()=>n;if(s.length===0){if(n=de(e,n,r),l)return n}else u?n.length===0?Xe(e,s,r):xt(e,n,s):(n&&de(e),Xe(e,s));n=s}else if(t.nodeType){if(Array.isArray(n)){if(l)return n=de(e,n,r,t);de(e,n,null,t)}else n==null||n===""||!e.firstChild?e.appendChild(t):e.replaceChild(t,e.firstChild);n=t}}return n}function Ge(e,t,n,r){let i=!1;for(let o=0,l=t.length;o<l;o++){let s=t[o],u=n&&n[e.length],f;if(!(s==null||s===!0||s===!1))if((f=typeof s)=="object"&&s.nodeType)e.push(s);else if(Array.isArray(s))i=Ge(e,s,u)||i;else if(f==="function")if(r){for(;typeof s=="function";)s=s();i=Ge(e,Array.isArray(s)?s:[s],Array.isArray(u)?u:[u])||i}else e.push(s),i=!0;else{const p=String(s);u&&u.nodeType===3&&u.data===p?e.push(u):e.push(document.createTextNode(p))}}return i}function Xe(e,t,n=null){for(let r=0,i=t.length;r<i;r++)e.insertBefore(t[r],n)}function de(e,t,n,r){if(n===void 0)return e.textContent="";const i=r||document.createTextNode("");if(t.length){let o=!1;for(let l=t.length-1;l>=0;l--){const s=t[l];if(i!==s){const u=s.parentNode===e;!o&&!l?u?e.replaceChild(i,s):e.insertBefore(i,n):u&&s.remove()}else o=!0}}else e.insertBefore(i,n);return[i]}var Ye=L(`<div class=code>
`),Rt=L("<div class=code><span class=bullet>"),Be=L("<div class=code>"),_t=L('<div class="row warn">'),kt=L("<div><div class=prompt-title></div><div class=prompt-sub>Parameter <!> of </div><div class=prompt-body><div class=code><span>"),It=L("<div><div class=prompt-title>Command Ready</div><div class=prompt-body><div class=code></div><div class=section-subtle>Enter: copy • Esc: back"),Tt=L("<div class=prompt-overlay><div class=prompt>"),Nt=L("<div class=app><div class=header>VTS Tools Browser</div><div class=main><div><div class=pane-title>Categories</div><div class=list></div></div><div><div class=pane-title>Commands</div><div class=list></div></div><div><div class=pane-title>Details</div><div class=list></div></div></div><div class=footer></div><div>"),Lt=L("<div><span class=bullet></span> (<!>)"),Mt=L("<div><span class=bullet>"),Ot=L("<div class=section>Build Command:"),Ut=L('<div class="code preview-cmd">'),Bt=L("<div class=section>Synopsis:"),Gt=L("<div class=section>Description:"),Ft=L("<div class=section-subtle>Press Enter to start the parameter wizard"),Vt=L("<div class=section>Examples:"),Ht=L("<div><div class=code><span class=section>Name: </span></div><div class=code><span class=section>Category: </span></div><div class=code><span class=section>Path: "),qt=L("<div> <!> &lt;<!>&gt; <!> ");const Ze=[{Category:"Utilities",Commands:[{Name:"Get-Thing",Category:"Utilities",Synopsis:"Gets a thing",Description:"Retrieves a sample thing.",Examples:[`Get-Thing -Name alpha
Name : alpha
Id   : 1`,`Get-Thing -Name beta
Name : beta
Id   : 2`],Parameters:[{Name:"Name",Required:!0,Type:"String",Position:0},{Name:"Verbose",Required:!1,Type:"Switch",Position:1}],Invocation:"Get-Thing",ScriptPath:"functions/Get-Thing.ps1"}]},{Category:"Networking",Commands:[{Name:"Test-Ping",Category:"Networking",Synopsis:"Ping a host",Description:"Pings a host and reports latency.",Examples:[`Test-Ping -Host example.com
Reply from 93.184.216.34: time=10ms`],Parameters:[{Name:"Host",Required:!0,Type:"String",Position:0},{Name:"Count",Required:!1,Type:"Int32",Position:1}],Invocation:"Test-Ping",ScriptPath:"functions/Test-Ping.ps1"}]}],De={bullet:"•"},Kt=window.__MODEL__??[],ne={owner:"roberto-ryan",repo:"Public",branch:"main",path:"functions",categoryDepth:2,ignore:["functions","function","scripts","script","src","source","powershell","pwsh","ps","bin","build",".github",".vscode","lib","modules","module","samples","examples","test","tests","docs","documentation"],categoryLabelStyle:"OwnerRepo"};function jt(){const e=new URLSearchParams(location.search),t=e.get("repo")||`${ne.owner}/${ne.repo}`,[n,r]=t.split("/");return{owner:n||ne.owner,repo:r||ne.repo,branch:e.get("branch")||ne.branch,path:(e.get("path")||ne.path).replace(/^\/+|\/+$|^\.\/?/g,"").replace(/\\/g,"/"),categoryDepth:Math.max(1,Math.min(5,parseInt(e.get("depth")||`${ne.categoryDepth}`)||ne.categoryDepth)),ignore:(e.get("ignore")||ne.ignore.join(",")).split(",").map(i=>i.trim()).filter(Boolean),token:e.get("token")||void 0,preferFolderCategory:(e.get("preferFolder")??"1")!=="0",categoryLabelStyle:(()=>{const i=e.get("label")||ne.categoryLabelStyle;return i==="Full"||i==="OwnerRepo"||i==="Repo"?i:"OwnerRepo"})()}}async function Wt(e){const t=[],n=[e.path.replace(/^\/+|\/+$/g,"")];for(;n.length;){const r=n.shift();try{const i=`https://api.github.com/repos/${encodeURIComponent(e.owner)}/${encodeURIComponent(e.repo)}/contents/${encodeURIComponent(r)}?ref=${encodeURIComponent(e.branch)}`,o={Accept:"application/vnd.github+json"};e.token&&(o.Authorization=`Bearer ${e.token}`);const l=await fetch(i,{headers:o});if(!l.ok)throw new Error(`GitHub list failed ${l.status}`);const s=await l.json();for(const u of s)u.type==="dir"?n.push(u.path):u.type==="file"&&u.name.toLowerCase().endsWith(".ps1")&&t.push(u)}catch(i){console.warn("List failed for",r,i)}}return t}async function Qt(e,t,n){const r=new Array(e.length);let i=0,o=0,l,s;const u=new Promise((p,a)=>{l=p,s=a}),f=()=>{for(;o<t&&i<e.length;){const p=i++;o++,Promise.resolve(n(e[p],p)).then(a=>{r[p]=a,o--,i>=e.length&&o===0?l(r):f()},a=>{s(a)})}};return f(),u}function zt(e){const t=e.match(/<#([\s\S]*?)#>/m);if(!t)return{};const n=t[1],r=v=>/^(none|no|parameters?|true|false|n\/a|na)$/i.test(v),i=Array.from(n.matchAll(/^\s*\.PARAMETER\s+([^\r\n]+)/gim)).map(v=>v[1].trim().split(/\s+/)[0]).filter(Boolean).filter(v=>!r(v)),o=n.split(/\r?\n/);let l=null;const s={};for(let v of o){const D=v.trim().match(/^\.(\w+)/);if(D){l=D[1].toUpperCase(),s[l]||(s[l]=[]);continue}l&&s[l].push(v.replace(/\s+$/,""))}const u=(s.SYNOPSIS||[]).join(`
`).trim(),f=(s.DESCRIPTION||[]).join(`
`).trim(),p=[],a=Object.keys(s).filter(v=>v==="EXAMPLE"||v.startsWith("EXAMPLE"));for(const v of a){const $=(s[v]||[]).join(`
`).trim();$&&p.push($)}const b=(s.LINK||[]).join(`
`).trim(),m=(s.CATEGORY||[]).join(`
`).trim(),_=v=>(v.replace(/\r\n/g,`
`).split(`
`).map($=>$.trim()).find(Boolean)||"").trim(),M=_(b)||_(m);return{synopsis:u,description:f,examples:p,paramHelpNames:i,linkCategory:M}}function Jt(e){const t=e.search(/param\s*\(/i),n=[];if(t<0)return n;const r=e.indexOf("(",t);if(r<0)return n;let i=r+1,o=1,l=null;for(;i<e.length;i++){const b=e[i],m=e[i-1];if(l){b===l&&(l==='"'&&m==="`"||(e[i+1]===l?i++:l=null));continue}else{if(b==='"'||b==="'"){l=b;continue}if(b==="(")o++;else if(b===")"&&(o--,o===0))break}}const s=e.slice(r+1,i),u=[];let f="",p=0,a=0;l=null;for(let b=0;b<s.length;b++){const m=s[b],_=s[b-1];if(l){f+=m,m===l&&(l==='"'&&_==="`"||(s[b+1]===l?(f+=s[b+1],b++):l=null));continue}if(m==='"'||m==="'"){l=m,f+=m;continue}if(m==="["){a++,f+=m;continue}if(m==="]"){a=Math.max(0,a-1),f+=m;continue}if(m==="("){p++,f+=m;continue}if(m===")"){p=Math.max(0,p-1),f+=m;continue}if(m===","&&p===0&&a===0){f.trim()&&u.push(f.trim()),f="";continue}f+=m}f.trim()&&u.push(f.trim());for(const b of u){const m=Array.from(b.matchAll(/\$([A-Za-z_][\w]*)\b/g));if(m.length===0)continue;const _=Y=>/^(true|false|null|env|_|psitem)$/i.test(Y),M=m.find(Y=>!_(Y[1]));if(!M)continue;const v=M[1],$=b.slice(0,M.index),D=Array.from($.matchAll(/\[([^\]]+)\]/g)).map(Y=>Y[1]);let N=!1,O=-1,g="";for(const Y of D){const j=Y.trim();if(j.toLowerCase().startsWith("parameter(")){const Z=j.slice(j.indexOf("(")+1,j.lastIndexOf(")")),ge=Z.match(/mandatory\s*=\s*\$?(true|false)/i);ge?N=ge[1].toLowerCase()==="true":/\bmandatory\b/i.test(Z)&&(N=!0);const oe=Z.match(/position\s*=\s*(-?\d+)/i);oe&&(O=parseInt(oe[1]))}else!/^validate\w*\s*\(/i.test(j)&&!/^alias\s*\(/i.test(j)&&(g=j)}const A=/switch/i.test(g)?"Switch":/bool/i.test(g)?"Boolean":/int(16|32|64)?/i.test(g)?"Int32":/string/i.test(g)?"String":g||"Object";n.push({Name:v,Required:N,Type:A,Position:O})}return n}const Xt=[[/\b(M365|O365|Office365|ExchangeOnline|SharePointOnline|OneDrive|Teams|Outlook|Planner|PowerPlatform|PowerApps|PowerAutomate)\b/i,"Microsoft 365"],[/\b(ActiveDirectory|ADFS|ADDS|DomainController|SAMAccount|Kerberos|LDAP|AAD|AzureAD|EntraID)\b/i,"Identity"],[/\b(Security|SecPol|ACL|Permissions|Credential|Secrets|PKI|Certificate|TLS|SSL|Firewall|Malware|Virus|Defender|AppLocker|BitLocker|Encryption)\b/i,"Security"],[/\b(Intune|SCCM|ConfigMgr|EndpointManager|MDM|GPO|GroupPolicy)\b/i,"Endpoint Mgmt"],[/\b(Azure|ARM|ResourceGroup|VMSS|AKS|AppService|KeyVault|StorageAccount|CosmosDB|LogicApp|FunctionApp|VNet|NSG)\b/i,"Azure"],[/\b(Jira|Confluence|DevOps|Agile|Scrum|Kanban|Trello|Asana)\b/i,"Dev/Work Mgmt"],[/\b(Hyper-V|VMware|vSphere|ESXi|VirtualBox|VHDX?|Snapshot|Checkpoint)\b/i,"Virtualization"],[/\b(Docker|Podman|Containerd|K8s|Kubernetes|Helm|Image|Container)\b/i,"Containers"],[/\b(DevOps|Terraform|Ansible|Chef|Puppet|Bicep|ARMTemplate|CI\/CD|Pipeline|Jenkins|Octopus)\b/i,"DevOps/IaC"],[/\b(SQLServer|MSSQL|Postgres|PostgreSQL|MySQL|MariaDB|OracleDB|MongoDB|Redis|Database|SQLite)\b/i,"Databases"],[/\b(OAuth|OIDC|SAML|JWT|FIDO2|MFA|2FA|SSO|AuthN|AuthZ)\b/i,"Auth Standards"],[/\b(AWS|AmazonWebServices|EC2|S3|GCP|GoogleCloud|BigQuery|CloudRun)\b/i,"Cloud Vendors"],[/\b(Network|NetCfg|DNS|DHCP|IPConfig|Ping|Traceroute|Subnet|Routing|Switch|Router|WiFi|NAT|Port|TCP|UDP|SSLVPN|VPN)\b/i,"Networking"],[/\b(PowerShell|Bash|Python|CSharp|C#|JavaScript|TypeScript|GoLang?|Rust|Perl|Ruby)\b/i,"Languages"],[/\b(Backup|Restore|Recovery|Snapshot|Replication|Failover|DisasterRecovery|DR|Veeam)\b/i,"Backup and DR"],[/\b(Exchange|SMTP|IMAP|POP3|Mailbox|MailFlow|SendMail)\b/i,"Email"],[/\b(Help|Get-Help|About_|Info|Discover|WhatIf)\b/i,"Help/Discovery"],[/\b(Process|Tasklist|Taskkill|Get-Process|ProcMon|Handle)\b/i,"Processes"],[/\b(Service|Get-Service|Set-Service|Start-Service|Stop-Service|Restart-Service)\b/i,"Services"],[/\b(File|Folder|Directory|Path|Copy-Item|Move-Item|Remove-Item|Rename-Item|New-Item|Get-ChildItem|Tree)\b/i,"Files/Directories"],[/\b(Registry|RegKey|HKLM|HKCU|HKCR|HKU|HKCC|Get-ItemProperty|Set-ItemProperty)\b/i,"Registry"],[/\b(EventLog|Get-EventLog|Get-WinEvent|LogName|ApplicationLog|SystemLog|Audit)\b/i,"Events/Logs"],[/\b(Device|PnP|Driver|Hardware|Disk|Volume|Partition|USB|PrinterPort|Monitor|Battery|Adapter)\b/i,"Hardware/Devices"],[/\b(Print|Printer|PrintJob|Spooler|PrintQueue)\b/i,"Printing"],[/\b(Update|Patch|WUInstall|WindowsUpdate|KB\d+)\b/i,"Updates"],[/\b(User|Group|LocalUser|LocalGroup|Account|SID|Profile|Credential|NTUser)\b/i,"Users/Groups"],[/\b(PerfMon|Performance|Counter|ResourceMonitor|CPU|Memory|DiskIO|Latency|Benchmark)\b/i,"Performance"],[/\b(PowerPlan|Battery|Sleep|Hibernate|Shutdown|Restart|Reboot|UPS)\b/i,"Power"],[/\b(Display|Resolution|Monitor|Screen|Graphics|DPI|Color|Brightness)\b/i,"Display"],[/\b(Keyboard|Mouse|Input|HID|Touchpad|Tablet|Pen)\b/i,"Input"],[/\b(Audio|Sound|Speaker|Microphone|Mute|Volume)\b/i,"Audio"],[/\b(Troubleshoot|Diag|Diagnosis|Fix|Repair|Checkup|Health|SFC|DISM)\b/i,"Troubleshooting"],[/\b(Install|Setup|Deployment|Sysprep|ImageX|WIM|ISO|Provisioning)\b/i,"Installation"],[/\b(Recovery|WinRE|Reset|RestorePoint|SystemRestore|BootRepair)\b/i,"Recovery"],[/\b(Util|Utility|Tool|Script|Helper|AdminTool|Sysinternals)\b/i,"Utilities"]];function Yt(e){const t=(e||"").replace(/\s+/g," ").trim();if(!t)return t;for(const r of[" - "," — ",":"," | "]){const i=t.indexOf(r);if(i>0)return t.slice(0,i).trim()}const n=t.split(" ");return n.length>5||t.length>40?n.slice(0,Math.min(4,n.length)).join(" "):t.replace(/\b(for|with|using|via|and|to|on)$/i,"").trim()}function Zt(e){let t=(e||"").trim();if(!t)return t;t=t.replace(/#.*$/,"").replace(/\?.*$/,"");const n=t.match(/github(?:usercontent)?\.com\/([^\/]+)\/([^\/]+)(?:\/(?:tree|blob)\/([^\/]+)\/)?/i);if(n){const r=n[1],i=n[2],o=n[3];return o?`${r}/${i}@${o}`:`${r}/${i}`}if(/^(https?:\/\/|www\.)/i.test(t))try{/^https?:\/\//i.test(t)||(t="https://"+t);const r=new URL(t),i=r.host,o=r.pathname.replace(/^\/+|\/+$/g,"");return o?`${i}/${o.split("/")[0]}`:i}catch{return e}return e}function et(e,t){const n=l=>l.replace(/[-_.]+/g," ").replace(/\b\w/g,s=>s.toUpperCase()),r=(e||"").trim();if(!r)return r;const i=r.match(/^([^/@]+)\/([^/@]+)(?:@([^@]+))?$/);if(i){const l=i[1],s=i[2],u=i[3];if(t==="Repo")return n(s);if(t==="OwnerRepo")return`${n(l)}/${n(s)}`;const f=`${n(l)}/${n(s)}`;return u?`${f}@${n(u)}`:f}const o=r.match(/^[^/]+\/([^/]+)$/);if(o){const l=o[1];return t==="Repo"?n(l):`${r.split("/")[0]}/${n(l)}`}return n(r)}function en(e,t){const n=(e||"").trim();return n?/^(https?:\/\/|www\.|mailto:|file:)/i.test(n)?et(Zt(n),t):et(Yt(n),t):""}function tn(e,t,n){const r=t.match(/^[\s\S]{0,2000}?function\s+([A-Za-z0-9_-]+)\b/m),i=(r==null?void 0:r[1])||n.split("/").pop().replace(/\.ps1$/i,""),o=zt(t),l=Jt(t),s=new Map(l.map(g=>[g.Name.toLowerCase(),g])),u=g=>new RegExp(`\\$${g}\\b`,"i").test(t);for(const g of o.paramHelpNames||[]){const A=g.toLowerCase();!s.has(A)&&u(g)&&s.set(A,{Name:g,Required:!1,Type:"String",Position:0})}const f=Array.from(s.values()).sort((g,A)=>g.Position-A.Position),p=o.linkCategory?en(o.linkCategory,e.categoryLabelStyle):"",a=n.replace(/\\/g,"/"),b=e.path.replace(/\\/g,"/").replace(/^\/+|\/+$/g,""),m=a.toLowerCase().indexOf(b.toLowerCase()),v=(m>=0?a.slice(m+b.length).replace(/^\/+/,""):a).split("/").slice(0,-1).filter(Boolean).filter(g=>!e.ignore.some(A=>A.toLowerCase()===g.toLowerCase())).slice(0,e.categoryDepth),$=v.length?v.join(" / "):"";let D="";const N=`${n}
${t||""}`;for(const[g,A]of Xt)if(g.test(N)){D=A;break}const O=e.preferFolderCategory?$||p||D||"General":p||$||D||"General";return{Name:i,Category:O,Synopsis:o.synopsis||"",Description:o.description||"",Examples:o.examples||[],Parameters:f,Invocation:i,ScriptPath:n}}async function nn(e,t){try{if(e.token){const r=`https://api.github.com/repos/${encodeURIComponent(e.owner)}/${encodeURIComponent(e.repo)}/contents/${encodeURIComponent(t.path)}?ref=${encodeURIComponent(e.branch)}`,i=await fetch(r,{headers:{Accept:"application/vnd.github+json",Authorization:`Bearer ${e.token}`}});if(!i.ok)return null;const o=await i.json();if(o&&typeof o.content=="string")try{return atob(o.content.replace(/\n/g,""))}catch{return null}return null}if(!t.download_url)return null;const n=await fetch(t.download_url);return n.ok?await n.text():null}catch{return null}}async function rn(e){const t=await Wt(e),r=(await Qt(t,6,async s=>{const u=await nn(e,s);return u?tn(e,u,s.path):null})).filter(Boolean),i=new Map;for(const s of r){const u=s.Category||"General";i.has(u)||i.set(u,[]),i.get(u).push(s)}const o=Array.from(i.entries()).sort((s,u)=>s[0].localeCompare(u[0])).map(([s,u])=>({Category:s,Commands:u.sort((f,p)=>f.Name.localeCompare(p.Name))})),l=`${e.owner}/${e.repo}@${e.branch} • ${e.path}`;return{groups:o,title:l}}function sn(){const e=jt(),[t,n]=K(Kt),[r,i]=K("Loading…"),[o,l]=K(""),[s,u]=K(0),[f,p]=K(0),[a,b]=K("cat"),[m,_]=K("Left/Right: change pane  |  Up/Down: select or scroll  |  Enter: build/copy command  |  Ctrl+C: exit"),[M,v]=K(""),[$,D]=K({}),[N,O]=K(0),[g,A]=K("off"),[Y,j]=K(0),[me,Z]=K(""),ge=" Left/Right: change pane  |  Up/Down: select or scroll  |  Enter: build/copy  |  Ctrl+C: exit ";_(ge);const oe=pe(()=>{var c;return((c=t()[s()])==null?void 0:c.Commands)??[]}),z=pe(()=>oe()[f()]);let Ve,He,H;const Ce=c=>{H&&H.scrollBy({top:c,behavior:"auto"})},qe=(c,w)=>{requestAnimationFrame(()=>{if(!c||w==null||w<0)return;const C=c.querySelectorAll(".row")[w];C&&typeof C.scrollIntoView=="function"&&C.scrollIntoView({block:"nearest"})})},Ke=c=>{const w=c.target;if(((w==null?void 0:w.tagName)||"").toLowerCase(),g()!=="off"){const S=z(),C=(S==null?void 0:S.Parameters)||[],x=Y();if(g()==="param"&&S&&C[x]){const P=C[x],W=P.Type||"String";if(/switch|boolean/i.test(W)){if(c.key===" "){const q=!!$()[P.Name];D({...$(),[P.Name]:!q}),c.preventDefault();return}if(c.key==="Enter"){const q=x+1;if(q<C.length)j(q);else{const F=z();if(F){const ee=je(F,$());ee.length?(j(ee[0]),A("param")):A("summary")}else A("summary")}return}if(c.key==="Escape"){A("off");return}return}else{if(c.key==="Enter"){const F=me().trim();if(F)D({...$(),[P.Name]:F});else{const ie={...$()};delete ie[P.Name],D(ie)}Z("");const ee=x+1;if(ee<C.length)j(ee);else{const ie=z();if(ie){const le=je(ie,$());le.length?(j(le[0]),A("param")):A("summary")}else A("summary")}return}if(c.key==="Escape"){A("off"),Z("");return}if(c.key==="Backspace"||c.key==="Delete"){Z(me().slice(0,-1)),c.preventDefault();return}if(c.key.length===1&&!c.ctrlKey&&!c.metaKey&&!c.altKey){Z(me()+c.key),c.preventDefault();return}return}}if(g()==="summary"){if(c.key==="Enter"){const P=z();P&&(ut(Ne(P)),ft("Command copied to clipboard")),A("off");return}if(c.key==="Escape"){A("off");return}return}}switch(c.key){case"Enter":{const S=z();if(S){const C=S.Parameters||[];if(C.length===0)A("summary");else{j(0);const x=C[0];/switch|boolean/i.test(x.Type||"")?Z(""):Z(String($()[x.Name]??"")),A("param"),_(" Enter: accept  |  Space: toggle  |  Esc: cancel ")}}break}case"ArrowUp":{a()==="cat"?(s()>0&&u(s()-1),c.preventDefault()):a()==="cmd"?(f()>0&&p(f()-1),c.preventDefault()):a()==="detail"&&(Ce(-24),c.preventDefault());break}case"ArrowDown":{a()==="cat"?(s()<t().length-1&&u(s()+1),c.preventDefault()):a()==="cmd"?(f()<oe().length-1&&p(f()+1),c.preventDefault()):a()==="detail"&&(Ce(24),c.preventDefault());break}case"PageUp":{a()==="detail"&&(Ce(-((H==null?void 0:H.clientHeight)||200)*.85),c.preventDefault());break}case"PageDown":{a()==="detail"&&(Ce(((H==null?void 0:H.clientHeight)||200)*.85),c.preventDefault());break}case"Home":{a()==="detail"&&H&&(H.scrollTo({top:0,behavior:"auto"}),c.preventDefault());break}case"End":{a()==="detail"&&H&&(H.scrollTo({top:H.scrollHeight,behavior:"auto"}),c.preventDefault());break}case"ArrowLeft":{a()==="cmd"?b("cat"):a()==="detail"&&b("cmd"),c.preventDefault();break}case"ArrowRight":{a()==="cat"?b("cmd"):a()==="cmd"&&b("detail"),c.preventDefault();break}}};wt(()=>{window.addEventListener("keydown",Ke),(async()=>{try{const{groups:c,title:w}=await rn(e);c.length===0?(n(Ze),i("Demo Data")):(n(c),i(w))}catch(c){l((c==null?void 0:c.message)||String(c)),n(Ze),i("Demo Data (GitHub load failed)")}u(0),p(0)})()}),it(()=>window.removeEventListener("keydown",Ke)),he(()=>{oe(),p(0)}),he(()=>{t(),qe(Ve,s())}),he(()=>{oe(),qe(He,f())}),he(()=>{const c=z();if(!c)return;const w={};for(const S of c.Parameters||[]){const C=S.Name;/switch|boolean/i.test(S.Type)?w[C]=!1:w[C]=""}D(w),O(0)});function ct(c){return`'${String(c).replace(/'/g,"''")}'`}function Ne(c){const w=c.Invocation||c.Name,S=$(),C=[],x=[],P=c.Parameters||[];for(const k of P){const q=k.Name;let F=S[q];const ee=/switch/i.test(k.Type);if(/boolean/i.test(k.Type),!(ee?!!F:F!=null&&String(F).trim()!==""))continue;if(ee){C.push(`-${q}`);continue}const le=/int|double|float|decimal/i.test(k.Type)?String(F):ct(String(F));typeof k.Position=="number"&&k.Position>=0?x.push({pos:k.Position,text:le}):C.push(`-${q} ${le}`)}return x.sort((k,q)=>k.pos-q.pos),[w,...x.map(k=>k.text),...C].join(" ")}function je(c,w){const S=[],C=c.Parameters||[];for(let x=0;x<C.length;x++){const P=C[x];if(!P.Required)continue;const W=P.Type||"String",k=w[P.Name];/switch|boolean/i.test(W)?k||S.push(x):(k==null||String(k).trim()==="")&&S.push(x)}return S}function ut(c){var w;(w=navigator.clipboard)==null||w.writeText(c).catch(()=>{const S=document.createElement("textarea");S.value=c,document.body.appendChild(S),S.select(),document.execCommand("copy"),document.body.removeChild(S)})}function ft(c){v(c),setTimeout(()=>v(""),1500)}he(()=>{g()==="off"&&_(ge)});const pt=(c=[])=>{const w=[];return c.slice(0,3).forEach((S,C)=>{C>0&&w.push(Ye());const x=S.replace(/\r\n/g,`
`).replace(/\r/g,`
`).split(`
`);x.length>0&&(w.push((()=>{var P=Rt(),W=P.firstChild;return h(W,()=>De.bullet),h(P,()=>x[0],null),P})()),w.push(Ye()));for(let P=1;P<x.length;P++)w.push((()=>{var W=Be();return h(W,()=>"  "+x[P].replace(/\s+$/,"")),W})())}),w};return(()=>{var c=Nt(),w=c.firstChild,S=w.nextSibling,C=S.firstChild,x=C.firstChild,P=x.nextSibling,W=C.nextSibling,k=W.firstChild,q=k.nextSibling,F=W.nextSibling,ee=F.firstChild,ie=ee.nextSibling,le=S.nextSibling,Le=le.nextSibling;return Ue(d=>Ve=d,P),h(P,B(X,{get when(){return o()},get children(){var d=_t();return h(d,o),d}}),null),h(P,B(Oe,{get each(){return t()},children:(d,I)=>(()=>{var E=Lt(),U=E.firstChild,V=U.nextSibling,y=V.nextSibling;return y.nextSibling,h(U,()=>De.bullet),h(E,()=>d.Category,V),h(E,()=>{var re;return((re=d.Commands)==null?void 0:re.length)??0},y),fe(()=>ue(E,"row "+(I()==s()?"selected":""))),E})()}),null),Ue(d=>He=d,q),h(q,B(Oe,{get each(){return oe()},children:(d,I)=>(()=>{var E=Mt(),U=E.firstChild;return h(U,()=>De.bullet),h(E,()=>d.Name,null),fe(()=>ue(E,"row "+(I()==f()?"selected":""))),E})()})),Ue(d=>H=d,ie),h(ie,B(X,{get when(){return z()},children:d=>(()=>{var I=Ht(),E=I.firstChild;E.firstChild;var U=E.nextSibling;U.firstChild;var V=U.nextSibling;return V.firstChild,h(E,()=>d().Name,null),h(U,()=>d().Category,null),h(V,()=>d().ScriptPath,null),h(I,B(X,{get when(){var y;return(y=d().Parameters)==null?void 0:y.length},get children(){return[Ot(),(()=>{var y=Ut();return h(y,()=>Ne(d())),y})()]}}),null),h(I,B(X,{get when(){return d().Synopsis},get children(){return Bt()}}),null),h(I,B(X,{get when(){return d().Synopsis},get children(){var y=Be();return h(y,()=>d().Synopsis),y}}),null),h(I,B(X,{get when(){return d().Description},get children(){return Gt()}}),null),h(I,B(X,{get when(){return d().Description},get children(){var y=Be();return h(y,()=>d().Description),y}}),null),h(I,B(X,{get when(){var y;return(y=d().Parameters)==null?void 0:y.length},get children(){return[Ft(),B(Oe,{get each(){return d().Parameters},children:(y,re)=>{const $e=y.Type||"String",be=$()[y.Name],Pe=/switch|boolean/i.test($e),Q=Pe?Pe&&!!be?"[On]":"[Off]":be?String(be):y.Required?"<required>":"";return(()=>{var J=qt(),ye=J.firstChild,Ae=ye.nextSibling,dt=Ae.nextSibling,We=dt.nextSibling,ht=We.nextSibling,Qe=ht.nextSibling;return Qe.nextSibling,h(J,()=>De.bullet,ye),h(J,()=>y.Name,Ae),h(J,$e,We),h(J,()=>y.Required?"(required)":"(optional)",Qe),h(J,Q?"— "+Q:"",null),fe(()=>ue(J,"code param-item "+(re()==N()?"selected":""))),J})()}})]}}),null),h(I,B(X,{get when(){var y;return(y=d().Examples)==null?void 0:y.length},get children(){return[Vt(),Je(()=>pt(d().Examples))]}}),null),I})()})),h(le,m),h(c,B(X,{get when(){return g()!=="off"},get children(){var d=Tt(),I=d.firstChild;return h(I,B(X,{get when(){return g()==="param"},get children(){var E=kt(),U=E.firstChild,V=U.nextSibling,y=V.firstChild,re=y.nextSibling;re.nextSibling;var $e=V.nextSibling,be=$e.firstChild,Pe=be.firstChild;return h(U,()=>{var te;return(te=z())==null?void 0:te.Name}),h(V,()=>Y()+1,re),h(V,()=>{var te,Q;return((Q=(te=z())==null?void 0:te.Parameters)==null?void 0:Q.length)||0},null),h(Pe,()=>{var ye;const te=z(),Q=(ye=te==null?void 0:te.Parameters)==null?void 0:ye[Y()];if(!Q)return"";const J=Q.Type||"String";if(/switch|boolean/i.test(J)){const Ae=!!$()[Q.Name];return`${Q.Name} <${J}> ${Q.Required?"(required)":"(optional)"} — ${Ae?"[On]":"[Off]"}

Space: toggle • Enter: next • Esc: cancel`}return`${Q.Name} <${J}> ${Q.Required?"(required)":"(optional)"}

${me()}_

Type to enter • Enter: next • Esc: cancel`}),E}}),null),h(I,B(X,{get when(){return g()==="summary"},get children(){var E=It(),U=E.firstChild,V=U.nextSibling,y=V.firstChild;return h(y,(()=>{var re=Je(()=>!!z());return()=>re()?Ne(z()):""})()),E}}),null),d}}),Le),h(Le,M),fe(d=>{var I="pane pane-cats "+(a()==="cat"?"active":""),E="pane pane-cmds "+(a()==="cmd"?"active":""),U="pane "+(a()==="detail"?"active":""),V="copy-toast "+(M()?"show":"");return I!==d.e&&ue(C,d.e=I),E!==d.t&&ue(W,d.t=E),U!==d.a&&ue(F,d.a=U),V!==d.o&&ue(Le,d.o=V),d},{e:void 0,t:void 0,a:void 0,o:void 0}),c})()}Et(()=>B(sn,{}),document.getElementById("root"));
